const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunk-pdf-lib-Ccybbrxw.js","assets/chunk-state-CZJejFfH.js"])))=>i.map(i=>d[i]);
import{I as N,_ as D,l as d}from"./index-BEU7aBfH.js";const A=10,P=16,B={id:"exchange",steps:[{id:"browse",targetSelector:"[data-tour='exchange-card']",titleKey:"tour.exchange.browse.title",descriptionKey:"tour.exchange.browse.description",placement:"bottom",completionEvent:{type:"auto",delay:3e3}},{id:"apply",targetSelector:"[data-tour='exchange-card']",titleKey:"tour.exchange.apply.title",descriptionKey:"tour.exchange.apply.description",placement:"bottom",completionEvent:{type:"swipe"},autoSwipe:{direction:"left"}},{id:"filters",targetSelector:"[data-tour='exchange-settings']",titleKey:"tour.exchange.filters.title",descriptionKey:"tour.exchange.filters.description",placement:"bottom",completionEvent:{type:"click"}}]};function F(){const e=new Date;return e.setDate(e.getDate()+A),e.setHours(P,0,0,0),e.toISOString()}const I={__identity:"tour-dummy-exchange",status:"open",submittedAt:new Date().toISOString(),submittingType:"referee",refereePosition:"head-one",requiredRefereeLevel:"N3",submittedByPerson:{__identity:"tour-dummy-submitter",firstName:"Max",lastName:"Mustermann",displayName:"Max Mustermann"},refereeGame:{__identity:"tour-dummy-referee-game-exchange",game:{__identity:"tour-dummy-game-exchange",gameNumber:"67890",startingDateTime:F(),encounter:{__identity:"tour-dummy-encounter-exchange",teamHome:{__identity:"tour-dummy-team-home-exchange",name:"VBC Anleitung"},teamAway:{__identity:"tour-dummy-team-away-exchange",name:"SC Hilfe"}},hall:{__identity:"tour-dummy-hall-exchange",name:"Turnhalle Tutorial",primaryPostalAddress:{__identity:"tour-dummy-address-exchange",city:"Bern"}}}}};function L(e){return e==="fr"||e==="it"?"fr":"de"}function S(e){if(!e)return"";try{return N(new Date(e),"dd.MM.yy")}catch{return d.warn("Failed to parse date for PDF report:",e),""}}function _(e){const t=e?.indoorAssociationReferee?.indoorReferee?.person;if(t)return t.displayName||`${t.firstName??""} ${t.lastName??""}`.trim()||void 0}function v(e){const t=e.refereeGame?.game;if(!t)return null;const a=t.group?.phase?.league?.leagueCategory?.name;if(a!=="NLA"&&a!=="NLB")return null;const n=e.refereeGame,r=_(n?.activeRefereeConvocationFirstHeadReferee),s=_(n?.activeRefereeConvocationSecondHeadReferee),u={gameNumber:t.number?.toString()??"",homeTeam:t.encounter?.teamHome?.name??"",awayTeam:t.encounter?.teamAway?.name??"",gender:t.group?.phase?.league?.gender??"m",hallName:t.hall?.name??"",location:t.hall?.primaryPostalAddress?.city??"",date:S(t.startingDateTime),startingDateTime:t.startingDateTime,firstRefereeName:r,secondRefereeName:s};return d.debug("[pdf-form-filler] Extracted report data:",u),u}function O(e){const t=e.refereeGame?.game?.group?.phase?.league?.leagueCategory?.name;return t==="NLA"||t==="NLB"?t:null}const E={gameNumber:"SpielNr",homeTeam:"Heimteam",awayTeam:"Gastteam",genderRadio:"Gruppe3",hallName:"Hallenname",location:"Ort",date:"Datum",firstRefereeName:"Text19",secondRefereeName:"Text20"},M={gameNumber:"Text9",homeTeam:"Text10",awayTeam:"Text12",genderRadio:"Gruppe15",hallName:"Text14",location:"Text13",date:"Text11",firstRefereeName:"Text23",secondRefereeName:"Text24"};function C(e){return e==="NLA"?E:M}function G(e,t){return`/volleykit/pr-923/assets/pdf/sports-hall-report-${e==="NLA"?"nla-":""}${t}.pdf`}async function R(e,t,a){const{PDFDocument:n}=await D(async()=>{const{PDFDocument:c}=await import("./chunk-pdf-lib-Ccybbrxw.js");return{PDFDocument:c}},__vite__mapDeps([0,1])),r=G(t,a),s=await fetch(r);if(!s.ok)throw new Error(`Failed to fetch PDF template: ${s.statusText}`);const u=await s.arrayBuffer(),p=await n.load(u),f=p.getForm(),o=C(t),i=(c,m)=>{if(m)try{f.getTextField(c).setText(m)}catch(l){d.warn(`Could not set text field "${c}":`,l)}},w=(c,m)=>{try{const l=f.getRadioGroup(c);try{l.select(m)}catch{const g=l.getOptions(),y=g.find(h=>h.toUpperCase().startsWith(m)||h.includes(m));y?l.select(y):d.warn(`Could not find option "${m}" in radio group "${c}". Available: ${g.join(", ")}`)}}catch(l){d.warn(`Could not access radio group "${c}":`,l)}};i(o.gameNumber,e.gameNumber),i(o.homeTeam,e.homeTeam),i(o.awayTeam,e.awayTeam),i(o.hallName,e.hallName),i(o.location,e.location),i(o.date,e.date);const b=e.gender==="m"?"Auswahl1":"Auswahl2";return w(o.genderRadio,b),i(o.firstRefereeName,e.firstRefereeName),i(o.secondRefereeName,e.secondRefereeName),p.save()}function T(e,t){const a=new Blob([new Uint8Array(e)],{type:"application/pdf"}),n=URL.createObjectURL(a),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)}const H={de:"hallenrapport",fr:"rapport_salle"};function x(e,t,a){const n=e.toLowerCase(),r=H[t],s=a?N(new Date(a),"yyyyMMdd"):"unknown";return`${n}_${r}_${s}.pdf`}async function $(e,t,a){const n=await R(e,t,a),r=x(t,a,e.startingDateTime);T(n,r)}const k=Object.freeze(Object.defineProperty({__proto__:null,buildReportFilename:x,downloadPdf:T,extractSportsHallReportData:v,fillSportsHallReportForm:R,generateAndDownloadSportsHallReport:$,getLeagueCategoryFromAssignment:O,mapAppLocaleToPdfLanguage:L},Symbol.toStringTag,{value:"Module"}));export{I as T,B as e,k as p};
