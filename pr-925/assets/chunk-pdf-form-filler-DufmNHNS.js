const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunk-pdf-lib-BvQ6aLDU.js","assets/chunk-state-1lfzh_F6.js"])))=>i.map(i=>d[i]);
import{I as N,l as u,_ as A}from"./index-bsFFBMyX.js";const D=10,P=16,B={id:"exchange",steps:[{id:"browse",targetSelector:"[data-tour='exchange-card']",titleKey:"tour.exchange.browse.title",descriptionKey:"tour.exchange.browse.description",placement:"bottom",completionEvent:{type:"auto",delay:3e3}},{id:"apply",targetSelector:"[data-tour='exchange-card']",titleKey:"tour.exchange.apply.title",descriptionKey:"tour.exchange.apply.description",placement:"bottom",completionEvent:{type:"swipe"},autoSwipe:{direction:"left"}},{id:"filters",targetSelector:"[data-tour='exchange-settings']",titleKey:"tour.exchange.filters.title",descriptionKey:"tour.exchange.filters.description",placement:"bottom",completionEvent:{type:"click"}}]};function F(){const e=new Date;return e.setDate(e.getDate()+D),e.setHours(P,0,0,0),e.toISOString()}const I={__identity:"tour-dummy-exchange",status:"open",submittedAt:new Date().toISOString(),submittingType:"referee",refereePosition:"head-one",requiredRefereeLevel:"N3",submittedByPerson:{__identity:"tour-dummy-submitter",firstName:"Max",lastName:"Mustermann",displayName:"Max Mustermann"},refereeGame:{__identity:"tour-dummy-referee-game-exchange",game:{__identity:"tour-dummy-game-exchange",gameNumber:"67890",startingDateTime:F(),encounter:{__identity:"tour-dummy-encounter-exchange",teamHome:{__identity:"tour-dummy-team-home-exchange",name:"VBC Anleitung"},teamAway:{__identity:"tour-dummy-team-away-exchange",name:"SC Hilfe"}},hall:{__identity:"tour-dummy-hall-exchange",name:"Turnhalle Tutorial",primaryPostalAddress:{__identity:"tour-dummy-address-exchange",city:"Bern"}}}}};function L(e){return e==="fr"||e==="it"?"fr":"de"}function S(e){if(!e)return"";try{return N(new Date(e),"dd.MM.yy")}catch{return u.warn("Failed to parse date for PDF report:",e),""}}function _(e){const t=e?.indoorAssociationReferee?.indoorReferee?.person;if(t)return t.displayName||`${t.firstName??""} ${t.lastName??""}`.trim()||void 0}function v(e){const t=e.refereeGame?.game;if(!t)return null;const a=t.group?.phase?.league?.leagueCategory?.name;if(a!=="NLA"&&a!=="NLB")return null;const r=e.refereeGame,o=_(r?.activeRefereeConvocationFirstHeadReferee),s=_(r?.activeRefereeConvocationSecondHeadReferee),m={gameNumber:t.number?.toString()??"",homeTeam:t.encounter?.teamHome?.name??"",awayTeam:t.encounter?.teamAway?.name??"",gender:t.group?.phase?.league?.gender??"m",hallName:t.hall?.name??"",location:t.hall?.primaryPostalAddress?.city??"",date:S(t.startingDateTime),startingDateTime:t.startingDateTime,firstRefereeName:o,secondRefereeName:s};return u.debug("[pdf-form-filler] Extracted report data:",m),m}function O(e){const t=e.refereeGame?.game?.group?.phase?.league?.leagueCategory?.name;return t==="NLA"||t==="NLB"?t:null}const E={gameNumber:"SpielNr",homeTeam:"Heimteam",awayTeam:"Gastteam",genderRadio:"Gruppe3",hallName:"Hallenname",location:"Ort",date:"Datum",firstRefereeName:"Text19",secondRefereeName:"Text20"},M={gameNumber:"Text9",homeTeam:"Text10",awayTeam:"Text12",genderRadio:"Gruppe15",hallName:"Text14",location:"Text13",date:"Text11",firstRefereeName:"Text23",secondRefereeName:"Text24"};function $(e){return e==="NLA"?E:M}function C(e,t){return`/volleykit/pr-925/assets/pdf/sports-hall-report-${e==="NLA"?"nla-":""}${t}.pdf`}async function R(e,t,a){const{PDFDocument:r}=await A(async()=>{const{PDFDocument:c}=await import("./chunk-pdf-lib-BvQ6aLDU.js");return{PDFDocument:c}},__vite__mapDeps([0,1])),o=C(t,a),s=await fetch(o);if(!s.ok)throw new Error(`Failed to fetch PDF template: ${s.statusText}`);const m=await s.arrayBuffer(),f=await r.load(m),p=f.getForm(),n=$(t),i=(c,l)=>{if(l)try{p.getTextField(c).setText(l)}catch(d){u.warn(`Could not set text field "${c}":`,d)}},T=(c,l)=>{try{const d=p.getRadioGroup(c);try{d.select(l)}catch{const g=d.getOptions(),y=g.find(h=>h.toUpperCase().startsWith(l)||h.includes(l));y?d.select(y):u.warn(`Could not find option "${l}" in radio group "${c}". Available: ${g.join(", ")}`)}}catch(d){u.warn(`Could not access radio group "${c}":`,d)}};i(n.gameNumber,e.gameNumber),i(n.homeTeam,e.homeTeam),i(n.awayTeam,e.awayTeam),i(n.hallName,e.hallName),i(n.location,e.location),i(n.date,e.date);const b=e.gender==="m"?"Auswahl1":"Auswahl2";return T(n.genderRadio,b),i(n.firstRefereeName,e.firstRefereeName),i(n.secondRefereeName,e.secondRefereeName),f.save()}function x(e,t){const a=new Blob([new Uint8Array(e)],{type:"application/pdf"}),r=URL.createObjectURL(a),o=document.createElement("a");o.href=r,o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(r)}const G={de:"hallenrapport",fr:"rapport_salle"};function w(e,t,a,r){const o=e.toLowerCase(),s=G[t];let m="unknown";if(a)try{m=N(new Date(a),"yyyyMMdd")}catch{u.warn("Failed to parse date for report filename:",a)}const f=r?`_${r}`:"";return`${o}_${s}_${m}${f}.pdf`}async function H(e,t,a){const r=await R(e,t,a),o=w(t,a,e.startingDateTime,e.gameNumber);x(r,o)}const k=Object.freeze(Object.defineProperty({__proto__:null,buildReportFilename:w,downloadPdf:x,extractSportsHallReportData:v,fillSportsHallReportForm:R,generateAndDownloadSportsHallReport:H,getLeagueCategoryFromAssignment:O,mapAppLocaleToPdfLanguage:L},Symbol.toStringTag,{value:"Module"}));export{I as T,B as e,k as p};
