const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunk-pdf-lib-Ccybbrxw.js","assets/chunk-state-CZJejFfH.js"])))=>i.map(i=>d[i]);
import{_ as w,I as b,l as d}from"./index-DaRM6nVF.js";const A=10,D=16,$={id:"exchange",steps:[{id:"browse",targetSelector:"[data-tour='exchange-card']",titleKey:"tour.exchange.browse.title",descriptionKey:"tour.exchange.browse.description",placement:"bottom",completionEvent:{type:"auto",delay:3e3}},{id:"apply",targetSelector:"[data-tour='exchange-card']",titleKey:"tour.exchange.apply.title",descriptionKey:"tour.exchange.apply.description",placement:"bottom",completionEvent:{type:"swipe"},autoSwipe:{direction:"left"}},{id:"filters",targetSelector:"[data-tour='exchange-settings']",titleKey:"tour.exchange.filters.title",descriptionKey:"tour.exchange.filters.description",placement:"bottom",completionEvent:{type:"click"}}]};function P(){const e=new Date;return e.setDate(e.getDate()+A),e.setHours(D,0,0,0),e.toISOString()}const U={__identity:"tour-dummy-exchange",status:"open",submittedAt:new Date().toISOString(),submittingType:"referee",refereePosition:"head-one",requiredRefereeLevel:"N3",submittedByPerson:{__identity:"tour-dummy-submitter",firstName:"Max",lastName:"Mustermann",displayName:"Max Mustermann"},refereeGame:{__identity:"tour-dummy-referee-game-exchange",game:{__identity:"tour-dummy-game-exchange",gameNumber:"67890",startingDateTime:P(),encounter:{__identity:"tour-dummy-encounter-exchange",teamHome:{__identity:"tour-dummy-team-home-exchange",name:"VBC Anleitung"},teamAway:{__identity:"tour-dummy-team-away-exchange",name:"SC Hilfe"}},hall:{__identity:"tour-dummy-hall-exchange",name:"Turnhalle Tutorial",primaryPostalAddress:{__identity:"tour-dummy-address-exchange",city:"Bern"}}}}};function F(e){return e==="fr"||e==="it"?"fr":"de"}function L(e){if(!e)return"";try{return b(new Date(e),"dd.MM.yy")}catch{return d.warn("Failed to parse date for PDF report:",e),""}}function N(e){const t=e?.indoorAssociationReferee?.indoorReferee?.person;if(t)return t.displayName||`${t.firstName??""} ${t.lastName??""}`.trim()||void 0}function S(e){const t=e.refereeGame?.game;if(!t)return null;const r=t.group?.phase?.league?.leagueCategory?.name;if(r!=="NLA"&&r!=="NLB")return null;const o=e.refereeGame,a=N(o?.activeRefereeConvocationFirstHeadReferee),l=N(o?.activeRefereeConvocationSecondHeadReferee),u={gameNumber:t.number?.toString()??"",homeTeam:t.encounter?.teamHome?.name??"",awayTeam:t.encounter?.teamAway?.name??"",gender:t.group?.phase?.league?.gender??"m",hallName:t.hall?.name??"",location:t.hall?.primaryPostalAddress?.city??"",date:L(t.startingDateTime),firstRefereeName:a,secondRefereeName:l};return d.debug("[pdf-form-filler] Extracted report data:",u),u}function v(e){const t=e.refereeGame?.game?.group?.phase?.league?.leagueCategory?.name;return t==="NLA"||t==="NLB"?t:null}const O={gameNumber:"SpielNr",homeTeam:"Heimteam",awayTeam:"Gastteam",genderRadio:"Gruppe3",hallName:"Hallenname",location:"Ort",date:"Datum",firstRefereeName:"Text19",secondRefereeName:"Text20"},C={gameNumber:"Text9",homeTeam:"Text10",awayTeam:"Text12",genderRadio:"Gruppe15",hallName:"Text14",location:"Text13",date:"Text11",firstRefereeName:"Text23",secondRefereeName:"Text24"};function E(e){return e==="NLA"?O:C}function G(e,t){return`/volleykit/assets/pdf/sports-hall-report-${e==="NLA"?"nla-":""}${t}.pdf`}async function _(e,t,r){const{PDFDocument:o}=await w(async()=>{const{PDFDocument:c}=await import("./chunk-pdf-lib-Ccybbrxw.js");return{PDFDocument:c}},__vite__mapDeps([0,1])),a=G(t,r),l=await fetch(a);if(!l.ok)throw new Error(`Failed to fetch PDF template: ${l.statusText}`);const u=await l.arrayBuffer(),f=await o.load(u),p=f.getForm(),n=E(t),i=(c,m)=>{if(m)try{p.getTextField(c).setText(m)}catch(s){d.warn(`Could not set text field "${c}":`,s)}},R=(c,m)=>{try{const s=p.getRadioGroup(c);try{s.select(m)}catch{const g=s.getOptions(),y=g.find(h=>h.toUpperCase().startsWith(m)||h.includes(m));y?s.select(y):d.warn(`Could not find option "${m}" in radio group "${c}". Available: ${g.join(", ")}`)}}catch(s){d.warn(`Could not access radio group "${c}":`,s)}};i(n.gameNumber,e.gameNumber),i(n.homeTeam,e.homeTeam),i(n.awayTeam,e.awayTeam),i(n.hallName,e.hallName),i(n.location,e.location),i(n.date,e.date);const T=e.gender==="m"?"Auswahl1":"Auswahl2";return R(n.genderRadio,T),i(n.firstRefereeName,e.firstRefereeName),i(n.secondRefereeName,e.secondRefereeName),f.save()}function x(e,t){const r=new Blob([new Uint8Array(e)],{type:"application/pdf"}),o=URL.createObjectURL(r),a=document.createElement("a");a.href=o,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(o)}async function H(e,t,r){const o=await _(e,t,r),a=`sports-hall-report-${e.gameNumber}-${r}.pdf`;x(o,a)}const B=Object.freeze(Object.defineProperty({__proto__:null,downloadPdf:x,extractSportsHallReportData:S,fillSportsHallReportForm:_,generateAndDownloadSportsHallReport:H,getLeagueCategoryFromAssignment:v,mapAppLocaleToPdfLanguage:F},Symbol.toStringTag,{value:"Module"}));export{U as T,$ as e,B as p};
