import{a as l,j as s}from"./chunk-state-1lfzh_F6.js";import{u as $,X as z,Y as F,Z as K,$ as B,a0 as W,a1 as q}from"./index-BgEF-jhP.js";import{a2 as yt}from"./index-BgEF-jhP.js";import{a as G}from"./chunk-assignments-DBz14qIH.js";import{T as Tt}from"./chunk-assignments-DBz14qIH.js";import{c as X}from"./chunk-compensations-BxlPJvCO.js";import{T as Et}from"./chunk-compensations-BxlPJvCO.js";import{e as Y}from"./chunk-pdf-form-filler-BA3VWPIY.js";import{T as St}from"./chunk-pdf-form-filler-BA3VWPIY.js";import{r as R}from"./chunk-router-BHRPxDXG.js";import"./chunk-validation-Cdg1t4SS.js";const Z={id:"settings",steps:[{id:"language",targetSelector:"[data-tour='language-switcher']",titleKey:"tour.settings.language.title",descriptionKey:"tour.settings.language.description",placement:"bottom",completionEvent:{type:"click"}},{id:"homeLocation",targetSelector:"[data-tour='home-location']",titleKey:"tour.settings.homeLocation.title",descriptionKey:"tour.settings.homeLocation.description",placement:"bottom",completionEvent:{type:"click"}},{id:"arrivalTime",targetSelector:"[data-tour='arrival-time']",titleKey:"tour.settings.arrivalTime.title",descriptionKey:"tour.settings.arrivalTime.description",placement:"bottom",completionEvent:{type:"click"}},{id:"complete",targetSelector:"[data-tour='tour-reset']",titleKey:"tour.settings.complete.title",descriptionKey:"tour.settings.complete.description",placement:"bottom",completionEvent:{type:"auto",delay:3e3}}]},U={assignments:G,compensations:X,exchange:Y,settings:Z};function H(e){return U[e]}function V(e){return U[e].steps.length}const J=1500,Q=800,tt=3;function et({targetSelector:e,direction:t,duration:c=J,delay:h=Q,onComplete:b}){const{t:d}=$(),u=l.useRef(null),g=l.useRef(!1),o=l.useRef(null),x=l.useCallback(()=>{if(g.current)return;const m=document.querySelector(e);if(!m)return;const i=".z-10.bg-white";let n=m.querySelector(i);if(n||(m.matches(i)?n=m:n=m.closest(i)),!n)return;g.current=!0;const T=tt,y=T*z+(T-1)*F+K,k=t==="left"?-y:y;m.dispatchEvent(new CustomEvent("tour-swipe-start",{bubbles:!0,detail:{translateX:k}}));const v=n.style.transition,I=n.style.transform,A=n.style.pointerEvents;n.style.pointerEvents="none",n.style.transition=`transform ${c}ms cubic-bezier(0.25, 0.1, 0.25, 1)`,requestAnimationFrame(()=>{n.style.transform=`translateX(${k}px)`}),o.current=()=>{n.style.transition=v,n.style.transform=I,n.style.pointerEvents=A};const r=setTimeout(()=>{n.style.transition=v,n.style.pointerEvents=A,o.current=null,m.dispatchEvent(new CustomEvent("tour-swipe-complete")),b()},c);return()=>clearTimeout(r)},[e,t,c,b]);return l.useEffect(()=>{const m=setTimeout(()=>{u.current=requestAnimationFrame(x)},h);return()=>{clearTimeout(m),u.current&&cancelAnimationFrame(u.current),o.current&&o.current()}},[h,x]),R.createPortal(s.jsx("div",{role:"status","aria-live":"polite","aria-atomic":"true",className:"sr-only",children:d("tour.accessibility.swipeDemoInProgress")}),document.body)}const C=8,L=16,p=12,O=16,rt=100,M="45",ot="z-[46]";function nt(e){const t=e.getBoundingClientRect();return{top:t.top-C,left:t.left-C,right:t.right+C,bottom:t.bottom+C,width:t.width+C*2,height:t.height+C*2}}function P(e,t,c){const h=window.innerWidth,b=window.innerHeight;let d=0,u=0;switch(c){case"bottom":d=e.bottom+L,u=e.left+e.width/2-t.width/2;break;case"top":d=e.top-t.height-L,u=e.left+e.width/2-t.width/2;break;case"left":d=e.top+e.height/2-t.height/2,u=e.left-t.width-L;break;case"right":d=e.top+e.height/2-t.height/2,u=e.right+L;break}return u=Math.max(O,Math.min(u,h-t.width-O)),d=Math.max(O,Math.min(d,b-t.height-O)),{top:d,left:u}}function st({targetSelector:e,placement:t,onDismiss:c,children:h,freezePosition:b=!1,disableBlur:d=!1,blockInteraction:u=!1,blockAllInteraction:g=!1}){const[o,x]=l.useState(null),[m,i]=l.useState({top:0,left:0}),[n,T]=l.useState(!1),y=l.useRef(null),{t:k}=$(),v=l.useCallback((r=!1)=>{if(b&&n&&!r)return;const a=document.querySelector(e);if(!a)return;const w=nt(a);x(w),T(!0),requestAnimationFrame(()=>{if(!y.current)return;const E=y.current.getBoundingClientRect(),f=P(w,E,t);i(f)})},[e,t,b,n]);if(l.useLayoutEffect(()=>{const r=document.querySelector(e);if(!r)return;const a=r,w=a.style.position,E=a.style.zIndex;a.style.position="relative",a.style.zIndex=M;const f=a.closest(".overflow-hidden");let S,N;return f&&f!==a&&(S=f.style.position,N=f.style.zIndex,f.style.position="relative",f.style.zIndex=M),()=>{a.style.position=w,a.style.zIndex=E,f&&f!==a&&(f.style.position=S??"",f.style.zIndex=N??"")}},[e]),l.useEffect(()=>{if(!o||!y.current)return;const r=y.current.getBoundingClientRect(),a=P(o,r,t);i(a)},[o,t]),l.useEffect(()=>{const r=document.querySelector(e);r&&(v(!0),r.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"}))},[e]),l.useEffect(()=>{const r=()=>v();window.addEventListener("resize",r,{passive:!0}),document.addEventListener("scroll",r,{passive:!0,capture:!0});let a=null;const w=()=>{a&&clearTimeout(a),a=setTimeout(r,rt)},E=new MutationObserver(w);return E.observe(document.body,{childList:!0,subtree:!0}),()=>{window.removeEventListener("resize",r),document.removeEventListener("scroll",r,{capture:!0}),a&&clearTimeout(a),E.disconnect()}},[v]),l.useEffect(()=>{const r=a=>{a.key==="Escape"&&c()};return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[c]),!o||!n)return null;const I=`polygon(
    0% 0%,
    0% 100%,
    ${o.left}px 100%,
    ${o.left}px ${o.top}px,
    ${o.right}px ${o.top}px,
    ${o.right}px ${o.bottom}px,
    ${o.left}px ${o.bottom}px,
    ${o.left}px 100%,
    100% 100%,
    100% 0%
  )`,A=()=>{const r={position:"absolute",width:0,height:0,borderStyle:"solid"};switch(t){case"bottom":return{...r,top:-p,left:"50%",transform:"translateX(-50%)",borderWidth:`0 ${p}px ${p}px ${p}px`,borderColor:"transparent transparent var(--arrow-color) transparent"};case"top":return{...r,bottom:-p,left:"50%",transform:"translateX(-50%)",borderWidth:`${p}px ${p}px 0 ${p}px`,borderColor:"var(--arrow-color) transparent transparent transparent"};case"left":return{...r,right:-p,top:"50%",transform:"translateY(-50%)",borderWidth:`${p}px 0 ${p}px ${p}px`,borderColor:"transparent transparent transparent var(--arrow-color)"};case"right":return{...r,left:-p,top:"50%",transform:"translateY(-50%)",borderWidth:`${p}px ${p}px ${p}px 0`,borderColor:"transparent var(--arrow-color) transparent transparent"}}};return R.createPortal(s.jsxs("div",{className:"tour-spotlight pointer-events-none",role:"dialog","aria-modal":"true","aria-label":k("tour.accessibility.spotlightLabel"),children:[g&&s.jsx("div",{className:"fixed inset-0 z-40 pointer-events-auto","aria-hidden":"true"}),s.jsx("div",{className:`fixed inset-0 z-40 bg-black/70 transition-opacity ${d?"":"backdrop-blur-sm"}`,style:{clipPath:I},"aria-hidden":"true"}),u&&s.jsx("div",{className:`fixed ${ot} pointer-events-auto`,style:{top:o.top,left:o.left,width:o.width,height:o.height},"aria-hidden":"true"}),s.jsxs("div",{ref:y,className:"fixed z-50 w-72 sm:w-80 bg-surface-card dark:bg-surface-card-dark rounded-xl shadow-2xl border border-border-subtle dark:border-border-subtle-dark/50 overflow-hidden pointer-events-auto",style:{top:m.top,left:m.left,"--arrow-color":"var(--color-surface-card)"},children:[s.jsx("div",{style:A(),className:"[--arrow-color:theme(colors.white)] dark:[--arrow-color:theme(colors.gray.800)]","aria-hidden":"true"}),h]})]}),document.body)}function it({titleKey:e,descriptionKey:t,currentStep:c,totalSteps:h,onSkip:b,onNext:d,onPrevious:u,isLastStep:g,isFirstStep:o}){const{t:x,tInterpolate:m}=$();return s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[s.jsx("h3",{className:"text-base font-semibold text-text-primary dark:text-text-primary-dark",children:x(e)}),s.jsx("button",{type:"button",onClick:b,className:"flex-shrink-0 p-1 -mr-1 -mt-1 rounded-md text-text-muted dark:text-text-muted-dark hover:text-text-secondary dark:hover:text-text-secondary-dark hover:bg-surface-subtle dark:hover:bg-surface-subtle-dark transition-colors","aria-label":x("tour.actions.skip"),children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("p",{className:"text-sm text-text-secondary dark:text-text-secondary-dark mb-4",children:x(t)}),s.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-border-subtle dark:border-border-subtle-dark",children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[Array.from({length:h}).map((i,n)=>s.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${n===c?"bg-primary-500":n<c?"bg-primary-300 dark:bg-primary-700":"bg-surface-muted dark:bg-surface-subtle-dark"}`,"aria-label":n===c?m("tour.stepCurrent",{step:n+1,total:h}):void 0},`step-${n}`)),s.jsxs("span",{className:"ml-2 text-xs text-text-muted dark:text-text-muted-dark",children:[c+1,"/",h]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[!o&&u&&s.jsx("button",{type:"button",onClick:u,className:"px-3 py-1.5 text-sm font-medium text-text-secondary dark:text-text-secondary-dark hover:text-text-primary dark:hover:text-text-primary-dark transition-colors",children:x("tour.actions.previous")}),d&&s.jsx("button",{type:"button",onClick:d,className:"px-4 py-1.5 text-sm font-medium bg-primary-500 text-primary-950 rounded-lg hover:bg-primary-600 transition-colors",children:x(g?"tour.actions.finish":"tour.actions.next")})]})]})]})}function xt({children:e}){const{activeTour:t,currentStep:c,nextStep:h,previousStep:b,completeTour:d,dismissTour:u}=B(),g=l.useRef(null),[o,x]=l.useState(null),i=(t?H(t):null)?.steps[c],n=t?V(t):0,T=c===n-1,y=c===0,k=!!i?.autoSwipe,v=k,I=o?.tour===t&&o?.step===c,A=k&&!I,r=l.useCallback(()=>{T?d():h()},[T,d,h]),a=l.useCallback(()=>{t!==null&&x({tour:t,step:c})},[t,c]),w=l.useCallback(()=>{r()},[r]),E=l.useCallback(()=>{b()},[b]),f=l.useCallback(()=>{u()},[u]);return l.useEffect(()=>{if(!i?.completionEvent)return;const{type:S,delay:N}=i.completionEvent;return S==="auto"&&N&&(g.current=setTimeout(()=>{r()},N)),()=>{g.current&&(clearTimeout(g.current),g.current=null)}},[i,r]),l.useEffect(()=>{if(!i?.completionEvent)return;const{type:S,selector:N}=i.completionEvent,D=N||i.targetSelector;if(S==="click"){const _=j=>{j.target.closest(D)&&setTimeout(()=>{r()},W)};return document.addEventListener("click",_,{capture:!0}),()=>document.removeEventListener("click",_,{capture:!0})}if(S==="swipe"){const _=()=>{setTimeout(()=>{r()},q)},j=document.querySelector(D);if(j)return j.addEventListener("tour-swipe-complete",_),()=>j.removeEventListener("tour-swipe-complete",_)}},[i,r]),!t||!i?s.jsx(s.Fragment,{children:e}):s.jsxs(s.Fragment,{children:[e,s.jsx(st,{targetSelector:i.targetSelector,placement:i.placement,onDismiss:f,freezePosition:v,disableBlur:v,blockInteraction:v,blockAllInteraction:!0,children:s.jsx(it,{titleKey:i.titleKey,descriptionKey:i.descriptionKey,currentStep:c,totalSteps:n,onSkip:f,onNext:w,onPrevious:y?void 0:E,isLastStep:T,isFirstStep:y})}),A&&i.autoSwipe&&s.jsx(et,{targetSelector:i.targetSelector,direction:i.autoSwipe.direction,duration:i.autoSwipe.duration,delay:i.autoSwipe.delay,onComplete:a})]})}export{Tt as TOUR_DUMMY_ASSIGNMENT,Et as TOUR_DUMMY_COMPENSATION,St as TOUR_DUMMY_EXCHANGE,yt as TourModeBanner,xt as TourProvider,st as TourSpotlight,it as TourTooltip,G as assignmentsTour,X as compensationsTour,Y as exchangeTour,H as getTourDefinition,V as getTourStepCount,Z as settingsTour,U as tourDefinitions};
