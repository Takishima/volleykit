import{a as u,j as n}from"./chunk-state-1lfzh_F6.js";import{c as y,bb as C,bc as k,aP as b,aQ as w,u as g,M as E,a as j,b as v,B as f}from"./index-D9XJkZ4R.js";import{m as P}from"./chunk-ModalErrorBoundary-gTB5KlCa.js";const _=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],h=y("file-text",_);function x(e){const t=e.methodOfDisbursementArbitration;return t==="payout_on_site"?e.lockPayoutOnSiteCompensation===!0:t==="central_payout"?e.lockPayoutCentralPayoutCompensation===!0:e.lockPayoutOnSiteCompensation===!0||e.lockPayoutCentralPayoutCompensation===!0}function L(e){if(e._permissions?.properties?.convocationCompensation?.update===!1)return!1;const t=e.convocationCompensation;return!(!t||t.paymentDone||x(t))}function z(e){if(P(e)||e._permissions?.properties?.convocationCompensation?.update===!1)return!1;const t=e.convocationCompensation;return t?!(t.paymentDone||x(t)):!0}const T=u.createElement(w,{size:b}),D=u.createElement(h,{size:b});function O(e,t){return{editCompensation:{id:"edit-compensation",label:"Edit Compensation",shortLabel:"Edit",color:"bg-primary-500",icon:T,onAction:()=>t.onEditCompensation(e)},generatePDF:{id:"generate-pdf",label:"Generate PDF",shortLabel:"PDF",color:"bg-slate-500",icon:D,onAction:()=>t.onGeneratePDF(e)}}}const F="https://volleykit-proxy.ngn-damien.workers.dev";async function U(e){const t=`${F}/indoorvolleyball.refadmin/refereestatementofexpenses/downloadrefereestatementofexpenses?refereeConvocation=${encodeURIComponent(e)}`;try{const o=await fetch(t,{method:"GET",credentials:"include",headers:{...C()}});if(k(o),!o.ok)throw new Error(`Failed to download PDF: ${o.statusText}`);const a=o.headers.get("Content-Type");if(!a)throw new Error("Missing Content-Type header in response");if(!a.trim().toLowerCase().startsWith("application/pdf"))throw new Error(`Invalid response type: expected PDF but received ${a}`);const s=await o.blob(),i=o.headers.get("Content-Disposition");let l="compensation.pdf";if(i){const d=i.match(/filename="?([^"]+)"?/);d&&d[1]&&(l=d[1])}const p=URL.createObjectURL(s),r=document.createElement("a");r.href=p,r.download=l,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(p)}catch(o){throw o instanceof Error?o:new Error("Unknown error occurred while downloading PDF",{cause:o})}}const m="pdf-lang-title",I=[{code:"de",name:"Deutsch"},{code:"fr",name:"FranÃ§ais"}];function M({isOpen:e,onClose:t,onConfirm:o,isLoading:a=!1,defaultLanguage:c="de"}){const{t:s}=g(),[i,l]=u.useState(c);u.useEffect(()=>{e&&l(c)},[e,c]);const p=n.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center",children:n.jsx(h,{className:"w-5 h-5 text-blue-600 dark:text-blue-400","aria-hidden":"true"})});return n.jsxs(E,{isOpen:e,onClose:t,titleId:m,size:"sm",isLoading:a,children:[n.jsx(j,{title:s("pdf.exportTitle"),titleId:m,titleSize:"lg",icon:p}),n.jsx("p",{className:"text-sm text-text-secondary dark:text-text-secondary-dark mb-4",children:s("pdf.selectLanguage")}),n.jsx("div",{className:"space-y-2 mb-6",children:I.map(({code:r,name:d})=>n.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-colors ${i===r?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-border-default dark:border-border-default-dark hover:bg-surface-subtle dark:hover:bg-surface-subtle-dark"}`,children:[n.jsx("input",{type:"radio",name:"pdf-lang",value:r,checked:i===r,onChange:()=>l(r),className:"w-4 h-4 text-blue-600",disabled:a}),n.jsx("span",{className:"text-text-primary dark:text-text-primary-dark",children:d})]},r))}),n.jsxs(v,{children:[n.jsx(f,{variant:"secondary",className:"flex-1",onClick:t,disabled:a,children:s("common.cancel")}),n.jsx(f,{variant:"blue",className:"flex-1",onClick:()=>o(i),disabled:a,children:a?n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),s("pdf.generating")]}):s("pdf.export")})]})]})}const R=Object.freeze(Object.defineProperty({__proto__:null,PdfLanguageModal:M},Symbol.toStringTag,{value:"Module"}));export{h as F,R as P,z as a,O as c,U as d,L as i};
